(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/hotel/booking"],{"29ef":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return i}));var i={faNavbar:function(){return n.e("components/fa-navbar/fa-navbar").then(n.bind(null,"076e"))},uForm:function(){return n.e("uview-ui/components/u-form/u-form").then(n.bind(null,"cb7ff"))},uFormItem:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-form-item/u-form-item")]).then(n.bind(null,"b721"))},uInput:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-input/u-input")]).then(n.bind(null,"4cfe"))},uCheckboxGroup:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-checkbox-group/u-checkbox-group")]).then(n.bind(null,"ad57"))},uCheckbox:function(){return n.e("uview-ui/components/u-checkbox/u-checkbox").then(n.bind(null,"adda"))},uButton:function(){return n.e("uview-ui/components/u-button/u-button").then(n.bind(null,"cec8"))},uIcon:function(){return n.e("uview-ui/components/u-icon/u-icon").then(n.bind(null,"f2bf"))},faCalendar:function(){return n.e("components/fa-calendar/fa-calendar").then(n.bind(null,"cf53"))},faCoupon:function(){return n.e("components/fa-coupon/fa-coupon").then(n.bind(null,"128a"))},uSkeleton:function(){return n.e("uview-ui/components/u-skeleton/u-skeleton").then(n.bind(null,"8aa9"))},uTopTips:function(){return n.e("uview-ui/components/u-top-tips/u-top-tips").then(n.bind(null,"c36b"))}},o=function(){var t=this,e=t.$createElement,n=(t._self._c,t.info.images&&t.info.images.length>0),i={backgroundColor:t.theme.bgColor,color:t.theme.color},o=t.info.coupon&&t.info.coupon.length>0,u=t.loading?null:{backgroundColor:t.theme.bgColor,color:t.theme.color};t._isMounted||(t.e0=function(e){t.value=!0},t.e1=function(e){t.is_update=!0,t.goPage("/pages/lodger/lodger?livenums="+t.info.livenums)},t.e2=function(e){t.show_coupon=!0}),t.$mp.data=Object.assign({},{$root:{g0:n,a0:i,g1:o,a1:u}})},u=[]},"5f79":function(t,e,n){},"6b3f":function(t,e,n){"use strict";(function(t,e){var i=n("4ea4");n("55e5");i(n("66fd"));var o=i(n("deff"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(o.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},"8d16":function(t,e,n){"use strict";var i=n("b3d7"),o=n.n(i);o.a},b3d7:function(t,e,n){},bca4:function(t,e,n){"use strict";n.r(e);var i=n("eb9b"),o=n.n(i);for(var u in i)["default"].indexOf(u)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(u);e["default"]=o.a},deff:function(t,e,n){"use strict";n.r(e);var i=n("29ef"),o=n("bca4");for(var u in o)["default"].indexOf(u)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(u);n("8d16"),n("eb93");var r=n("f0c5"),s=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"8920cb06",null,!1,i["a"],void 0);e["default"]=s.exports},eb93:function(t,e,n){"use strict";var i=n("5f79"),o=n.n(i);o.a},eb9b:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={onLoad:function(t){this.id=t.id||"",this.start_time=t.start_time||"",this.end_time=t.end_time||"",this.getHouseBooking()},onShow:function(){this.is_update&&this.getHouseBooking()},computed:{houseTotalPrice:function(){var t=parseFloat(this.calendar.amount?this.calendar.amount:this.info.price);return t.toFixed(2)},totalPrice:function(){if(!this.houseTotalPrice)return 0;var t=parseFloat(this.houseTotalPrice);return this.coupon.id&&(1==this.coupon.result?t-=this.coupon.result_data.number:t=t*this.coupon.result_data.number/10),t.toFixed(2)},coupon_price:function(){return(this.houseTotalPrice-this.totalPrice).toFixed(2)}},data:function(){return{statusBarHeight:t.getSystemInfoSync().statusBarHeight,navbarHeight:44,id:"",start_time:"",end_time:"",start_end_time:"",info:{},loading:!0,value:!1,is_update:!1,labelPosition:"left",lodger_ids:[],lodgerList:[],calendar:{},show_coupon:!1,coupon:{},child_price:null,deposit:null}},watch:{end_time:function(t,e){this.start_end_time=this.formatTime(this.start_time)+"入住 - "+this.formatTime(t)+"离店"}},methods:{formatTime:function(t){var e=t.split("-");return e[1]+"月"+e[2]+"日"},getHouseBooking:function(){var e=this;this.$api.houseBooking({id:this.id,start_time:this.start_time,end_time:this.end_time}).then((function(n){1==n.code?(e.info=n.data.detail,e.$u.vuex("vuex_livenums",e.info.livenums),n.data.lodger.map((function(t){-1!=e.vuex_lodgerids.indexOf(t.id)?t.checked=!0:t.checked=!1})),e.lodgerList=n.data.lodger,e.loading=!1,e.lodger_ids=e.vuex_lodgerids):(e.$u.toast(n.msg),setTimeout((function(){t.navigateBack({delta:1})}),1e3))}))},success:function(t){this.coupon=t},calendarConfirm:function(t){this.start_time=t.start,this.end_time=t.end,this.calendar=t},checkboxGroupChange:function(t){this.$u.vuex("vuex_lodgerids",this.lodger_ids)},checkboxChange:function(t){var e=this;if(t.value)this.lodger_ids.length>=this.info.livenums&&this.lodger_ids.length>0&&this.lodgerList.forEach((function(t,n){t.id==e.lodger_ids[0]&&setTimeout((function(){e.$set(e.lodgerList[n],"checked",!1),e.lodger_ids.splice(0,1)}),100)})),this.lodger_ids.push(t.name),this.queryPrice(t);else{var n=this.lodger_ids.indexOf(t.name);-1!=n&&this.lodger_ids.splice(n,1),this.child_price=null,this.deposit=null}},queryPrice:function(t){var e=this;3==this.info.store.type&&this.$api.queryPrice({id:this.info.id,lodger_id:t.name,start_time:this.start_time,end_time:this.end_time}).then((function(t){e.child_price=t.data.child_price.toFixed(2),e.deposit=t.data.details.deposit}))},submit:function(){var t=this;this.lodger_ids.length>this.info.livenums?this.$u.toast("不能超过"+this.info.livenums+"人居住"):this.$api.addOrder({id:this.id,start_time:this.start_time,end_time:this.end_time,user_coupon_id:this.coupon.user_coupon_id||"",lodger_ids:this.lodger_ids,type:0}).then((function(e){1==e.code?(t.$u.toast(e.msg),setTimeout((function(){"toshopay"==e.data.status?t.goPage("/pages/order/houseorder"):t.goPage("/pages/order/payment?id="+e.data.id)}),1e3)):t.$refs.uTips.show({title:e.msg,type:"error",duration:"5000"})}))}}};e.default=n}).call(this,n("543d")["default"])}},[["6b3f","common/runtime","common/vendor"]]]);